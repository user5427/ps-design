@startuml
!theme plain

actor Customer
actor Employee
participant "POS System" as POS
participant "Backend Server" as Server
participant "Stripe API" as Stripe

== Payment Start ==
Employee -> Customer        : Ask for payment method
Customer -> Employee        : Choose payment method (card / cash / gift card)
Employee -> POS             : Initialize payment session
POS      -> Server          : Create payment session

== Card Payment ==

Employee -> Customer        : Request card details
Customer -> POS             : Enter card details
POS      -> Server          : Process card payment
Server   -> Stripe          : Request payment intent
Stripe   -> Server          : Return intent reference
Server   -> POS             : Update payment status

== Cash / Gift Card ==
Employee -> Customer        : Request cash or gift card
Customer -> Employee        : Provide cash or gift card
Employee -> POS             : Record payment
POS      -> Server          : Save payment

== Tip ==
Employee -> Customer        : Ask for tip
Customer -> Employee        : Provide tip amount
Employee -> POS             : Add tip to session
POS      -> Server          : Save tip

== Finalization ==
Server   -> Server          : Generate receipt
Server   -> POS             : Provide receipt
Employee -> Customer        : Show/print receipt

== Refund (optional) ==
Customer -> Employee        : Request refund
Employee -> POS             : Initiate refund
POS      -> Server          : Process refund request
Server   -> Stripe          : Issue refund (if card)
Stripe   -> Server          : Return refund result
Server   -> POS             : Update refund status
Employee -> Customer        : Confirm refund
@enduml